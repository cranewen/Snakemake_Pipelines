# Snakemake_Pipelines

##### This SGE cluster pipeline is built upon Snakemake package. It features Bcl2fastq, RNA-seq, ChIP-seq, Cut&Tag-seq, CRISPR, DEseq2 pipelines.
##### Bcl2fastq pipeline does convert bcl to fastq files and demultiplexing them.
##### RNA-seq pipeline features STAR alignment to get BAMs, then using picard to pre-process the BAMs by adding various metadata tags for further analyses. Using samtools to indexing the BAMs, and then getting stats and flagstats from the BAMs. Then remove duplicate by using picard MarkDuplicates. Getting the read counts by using htseq-count with both duplicates removed BAMS and duplicates not removed BAMS. Generating TDFs with igvtools, same for the Wig files. Finally, it does a multiqc from all the stats that samtools generated.
##### ChIP-seq pipeline features similar functionalities as the RNA-seq pipeline. However, there is a key extra step which is the MACS peak calling process. With the assistant of bedtools for sorting the peak files and calculate the coverage counts with selected TSS reference. Then it is able to calculate the instersect within all the samples or a existing reference or customized reference by using bedtools intersect. The pipeline calculates a permutated list for writing a bedtools intersect bash file. So, the pipeline run the script straight from the bash file to get all the overlap counts by designed comparisons. Lastly, do the multiqc. 
##### Cut&Tag-seq pipeline is Similar to ChIP-seq pipeline, but without the insersect calculation.
##### CRISPR pipeline is a manual and automation mixed pipeline. Manual part is to prepare a matrix for Mageck-vispr to perform its MLE algorithm for sample group pairs analysis. Once the matrix is prepared, all other steps are automated by the pipeline.
##### The tornado pipeline is using deeptools to perform a series processes to plot the tornado figure. The purpose is to show the ChIP-seq peak signal around a group of regions the lab works on, such as enhancers, TSS.  
